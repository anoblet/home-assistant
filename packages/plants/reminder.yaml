plants_reminder:
  # Input boolean to serve as the plant watering reminder switch
  input_boolean:
    plants_water:
      name: Plants Need Watering
      initial: off
      icon: mdi:flower

  # Automation to turn on the reminder every TWO weeks on Monday
  automation:
    - alias: "Set Biweekly Plant Watering Reminder"
      trigger:
        - platform: time_pattern
          hours: 8
          minutes: 0
          seconds: 0
      condition:
        - condition: template
          value_template: >
            {{ now().strftime('%u') == '1' and 
              (as_timestamp(now()) // 86400) % 14 == 0 }}
      action:
        - service: input_boolean.turn_on
          target:
            entity_id: input_boolean.plants_water
        - service: notify.mobile_app_pixel_4_xl
          data:
            message: "It's time to water your plants! (Once every two weeks)"
            title: "Plant Watering Reminder"

    # Daily reminder if plants still need watering
    - alias: "Daily Plant Watering Reminder"
      trigger:
        - platform: time
          at: "08:00:00"
      condition:
        - condition: state
          entity_id: input_boolean.plants_water
          state: "on"
      action:
        - service: notify.mobile_app_pixel_4_xl
          data:
            message: "Don't forget to water your plants!"
            title: "Plant Watering Reminder"

    # Handle manual turning off of the switch
    - alias: "Acknowledge Plants Watered"
      trigger:
        - platform: state
          entity_id: input_boolean.plants_water
          from: "on"
          to: "off"
      action:
        - service: notify.mobile_app_pixel_4_xl
          data:
            message: "Great job watering your plants!"
            title: "Plants Watered"
